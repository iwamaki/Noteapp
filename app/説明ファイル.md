# アプリケーション概要と責任

## App.tsx

*   **概要:** Noteappアプリケーションの主要なエントリポイント。ルートナビゲーション構造を初期化し、テーマとユーザー設定を読み込みます。
*   **責任:**
    *   トップレベルのアプリケーションレイアウトとナビゲーションフローを設定し、すべてのコア機能にアクセスできるようにする。
    *   アプリケーション起動時にユーザー設定を読み込む (`useSettingsStore` の `loadSettings` を呼び出す)。
    *   ロガーのカテゴリを `chat` と `llm` に設定する。
    *   `ThemeProvider` を使用してアプリケーション全体にテーマを適用する。
    *   `RootNavigator` をレンダリングし、アプリケーションのナビゲーションを管理する。

## index.ts

*   **概要:** Expoアプリケーションのルートコンポーネントを登録し、アプリケーションのエントリポイントとして機能します。
*   **責任:**
    *   `App.tsx` で定義されたメインの `App` コンポーネントを `registerRootComponent` を用いて登録し、Expo Goまたはネイティブビルド環境でアプリケーションが適切に初期化されるようにする。

## components/CustomHeader.tsx

*   **概要:** アプリケーションのカスタムヘッダーコンポーネントと、ヘッダー設定を生成するフックを定義します。
*   **責任:** アプリケーション全体で一貫性のあるヘッダーUIを提供し、タイトル、左右のボタンなどの要素を柔軟に設定できるようにする。

## components/FabButton.tsx

*   **概要:** アプリケーションのフローティングアクションボタン（FAB）コンポーネントを定義します。
*   **責任:** 画面上で主要なアクションをトリガーするための視覚的に目立つボタンを提供し、サイズ、アイコン、色などのカスタマイズを可能にする。

## components/HeaderButton.tsx

*   **概要:** アプリケーションのヘッダーで使用されるボタンコンポーネントを定義します。
*   **責任:** ヘッダー内に配置されるアクションボタンのスタイルと動作を標準化し、視覚的な一貫性と再利用性を提供する。

## components/ListItem.tsx

*   **概要:** アプリケーションのリストアイテムコンポーネントを定義します。
*   **責任:** ノート一覧などのリスト表示において、各アイテムのタイトル、サブタイトル、選択状態、およびアクションを視覚的に表現する。

## features/chat/ChatInputBar.tsx

*   **概要:** アプリケーションのチャット入力バーコンポーネントを定義します。
*   **責任:** ユーザーがメッセージを入力して送信するためのUIを提供し、チャット履歴の表示と管理、およびキーボードの表示状態に応じたレイアウト調整を行う。

## features/chat/components/ChatHistory.tsx

*   **概要:** チャットメッセージの履歴を表示するコンポーネントを定義します。
*   **責任:** ユーザーとAIの間のチャット履歴を効率的に表示し、ローディング状態を示す。また、履歴表示エリアの展開・折りたたみ機能を提供する。

## features/chat/components/MessageItem.tsx

*   **概要:** 個々のチャットメッセージを表示するコンポーネントを定義します。
*   **責任:** ユーザー、AI、システムからのメッセージを区別して表示し、Markdown形式のコンテンツを適切にレンダリングする。

## features/chat/hooks/useChat.ts

*   **概要:** チャット機能のロジックをカプセル化するカスタムフックを定義します。
*   **責任:** チャットメッセージの送受信、状態管理（メッセージ履歴、ローディング状態）、およびLLMからの応答処理（コマンドの実行を含む）を担当する。チャットエリアの高さ調整機能も提供する。

## features/diff-view/DiffViewScreen.tsx

*   **概要:** アプリケーションの差分表示画面をレンダリングします。
*   **責任:** ノートの変更履歴やドラフト内容の差分を表示し、選択した変更を適用またはバージョンを復元する機能を提供する。

## features/diff-view/components/DiffViewer.tsx

*   **概要:** アプリケーションの差分表示コンポーネントを定義します。
*   **責任:** 2つのテキスト間の差分を視覚的に表示し、ユーザーが変更ブロックを選択・解除できる機能を提供する。

## features/note-edit/NoteEditScreen.tsx

*   **概要:** ノート編集画面のメインコンポーネントを定義します。
*   **責任:** ノートのタイトルとコンテンツの編集、保存、および異なる表示モード（編集、プレビュー、差分）間の切り替え機能を提供する。

## features/note-edit/components/FileEditor.tsx

*   **概要:** アプリケーションのファイルエディタコンポーネントを定義します。
*   **責任:** ユーザーがファイルのコンテンツを編集、プレビュー、または差分表示できるインターフェースを提供し、異なる表示モード間の切り替えを管理する。

## features/note-edit/components/NoteEditHeader.tsx

*   **概要:** ノート編集画面のヘッダータイトル入力コンポーネントを定義します。
*   **責任:** ノートのタイトル入力フィールドを提供し、IME入力の開始・終了を検知して親コンポーネントに通知する。

## features/note-edit/components/editors/DiffPreview.tsx

*   **概要:** 差分プレビューコンポーネントを定義します。
*   **責任:** 差分表示と、差分ブロックの選択・適用・キャンセル機能を提供する。

## features/note-edit/components/editors/MarkdownPreview.tsx

*   **概要:** マークダウンコンテンツのプレビュー表示コンポーネントを定義します。
*   **責任:** マークダウン形式のテキストを整形して表示する。

## features/note-edit/components/editors/TextEditor.tsx

*   **概要:** テキスト編集コンポーネントを定義します。
*   **責任:** ユーザーがテキストコンテンツを入力・編集するためのUIを提供する。

## features/note-edit/hooks/useNoteEditHeader.tsx

*   **概要:** ノート編集画面のヘッダー設定ロジックを管理するカスタムフックです。
*   **責任:** ナビゲーションヘッダーのボタン（編集、プレビュー、保存、履歴、差分表示など）の表示状態とアクションを制御する。

## features/note-edit/hooks/useNoteEditor.tsx

*   **概要:** ノート編集画面のロジックをカプセル化するカスタムフックです。
*   **責任:** ノートの読み込み、タイトルとコンテンツの管理、変更の自動保存（デバウンス付き）、および差分表示画面への遷移ロジックを提供する。

## features/note-edit/utils/fileViewerConfig.ts

*   **概要:** ファイル形式別の表示設定と、ファイル名から適切なビューア設定を取得する関数を定義します。
*   **責任:** 異なるファイル拡張子に対応する編集可能性や表示方法のルールを一元的に管理する。
