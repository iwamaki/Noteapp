# 作業指示プロンプト

このドキュメントは、LLM（私）が開発タスクを遂行するための指示書として機能します。

## あなたの役割とワークフロー:

**STEP 1: ドキュメントの読み込み**
ユーザーからの指示に基づき、この `work_instruction_prompt.md` を読み込みます。

**STEP 2: 構想情報の収集**
`docs/仕様書` フォルダ内のドキュメントを優先的に参照し、アプリケーションの全体構想、要件、画面遷移、ユーザー体験に関する詳細情報を収集します。これにより、実装の方向性を正確に理解します。

**STEP 3: 現在の実装状況の確認**
`docs/implementation_status.md` を読み込み、現在の実装状況を把握します。これにより、既存のコードベースと進捗を正確に理解します。

**STEP 4: 課題（issue）の特定と提案**
`issue` セクションに記載されている課題を優先的に特定し、ユーザーに解決を提案します。空ファイルの作成や実装は、ユーザーからの明確な指示がない限り行いません。

**STEP 5: 詳細情報の参照**
選択された課題の実装に必要な詳細情報は、`docs/仕様書` フォルダ内の関連ドキュメントを参照して収集します。

**STEP 6: 実装と検証**
ユーザーが選択した課題に対し、計画を立て、コードの変更、テスト、リンターチェックなどの検証を行います。

**STEP 7: 進捗の更新提案**
課題の解決が完了したら、`docs/implementation_status.md` の該当箇所を更新するようユーザーに提案します。

---

## issue

- 画面遷移が実装されてない。ヘッダーにNote 画面中央にNotelistと書いてあるだけである。画面遷移をまずはお願いしたい。

---


## 現在の実装

### フロントエンド (React Native)

#### `App.tsx`
アプリケーションのルートコンポーネントで、`RootNavigator`をレンダリングして全体のナビゲーション構造を確立します。

#### `index.ts`
Expoアプリケーションのエントリーポイントで、`App`コンポーネントをルートコンポーネントとして登録します。

### `src/components/chat/`

#### `ChatComponent.tsx`
AIチャット機能のUIコンポーネント。ユーザーとAIのメッセージ表示、テキスト入力、メッセージ送信、および`LLMService`との連携を処理します。コマンドの受信や警告表示機能も含まれます。

### `src/components/common/`

#### `ChatButton.tsx`
チャット機能を開くための再利用可能なボタンコンポーネント。ナビゲーションバーなどに配置することを想定しています。

### `src/components/diff/`

#### `DiffView.tsx`
テキストの差分を表示するためのコンポーネント。追加、削除、共通の行を色分けして表示し、個々の変更ブロックの選択・非選択、全選択、適用、キャンセル機能を提供します。

### `src/components/editor/`

#### `FileEditor.tsx`
ファイルの内容を表示・編集するためのコンポーネント。コンテンツ表示、編集、プレビュー、差分表示の各モードをサポートし、ファイルの種類（テキスト、マークダウン、コード、画像、PDFなど）に応じて編集可否を制御します。変更の保存時には差分確認プロセスを挟むことができます。

### `src/hooks/`

#### `useChat.ts`
（空ファイル）チャット関連のロジックをカプセル化するためのカスタムフックのプレースホルダーです。

#### `useDiff.ts`
（空ファイル）差分表示関連のロジックをカプセル化するためのカスタムフックのプレースホルダーです。

#### `useNotes.ts`
（空ファイル）ノート関連のロジックをカプセル化するためのカスタムフックのプレースホルダーです。

### `src/navigation/`

#### `RootNavigator.tsx`
アプリケーション全体のナビゲーションを管理するコンポーネント。`react-navigation`のスタックナビゲーターを使用して、ノートリスト、ノート編集、差分表示、バージョン履歴、設定画面間の遷移を定義します。

#### `types.ts`
ナビゲーションスタックのルートと、各画面に渡されるパラメータの型定義を提供します。

### `src/screens/`

#### `DiffViewScreen.tsx`
ファイル間の差分を表示し、選択した変更を適用するための画面。`DiffView`コンポーネントを利用して、元の内容と新しい内容の差分をユーザーに提示します。

#### `HomeScreen.tsx`
基本的なホーム画面コンポーネント。

#### `NoteEditScreen.tsx`
ノートの編集を行う画面。`FileEditor`コンポーネントを統合し、ノートの内容を編集・保存できます。また、`ChatComponent`も組み込まれており、AIとの対話を通じてノート編集をサポートします。

#### `NoteListScreen.tsx`
ノートの一覧を表示する画面コンポーネント。

#### `SettingsScreen.tsx`
基本的な設定画面コンポーネント。

#### `VersionHistoryScreen.tsx`
基本的なバージョン履歴画面コンポーネント。

### `src/services/`

#### `api.ts`
アプリケーションの主要なAPIサービス。ノートのCRUD操作を行う`NoteAPI`と、LLM（大規模言語モデル）との通信を管理する`LLMService`を統合し、一元的なインターフェースを提供します。

#### `llmService.ts`
LLMとの対話を管理するサービス。チャットメッセージの送受信、LLMプロバイダーとモデルの管理、会話履歴の保存、およびLLMのヘルスチェック機能を提供します。`MessageProcessor`クラスも含まれ、コマンドの検証やパスの結合を行います。

#### `storageService.ts`
（空ファイル）ローカルストレージや永続ストレージとの連携を管理するためのサービスのプレースホルダーです。

### `src/store/`

#### `index.ts`
（空ファイル）ReduxやZustandなどの状態管理ストアを統合するためのプレースホルダーです。

#### `noteStore.ts`
（空ファイル）ノートの状態管理ロジックをカプセル化するためのストアのプレースホルダーです。

#### `settingsStore.ts`
（空ファイル）アプリケーション設定の状態管理ロジックをカプセル化するためのストアのプレースホルダーです。

### `src/types/`

#### `api.ts`
`shared/types/api`からAPI関連の型定義を再エクスポートします。

#### `index.ts`
（空ファイル）アプリケーション全体の共通型定義を統合するためのプレースホルダーです。

#### `note.ts`
`shared/types/note`からノート関連の型定義を再エクスポートします。

### `src/utils/`

#### `constants.ts`
`shared/utils/constants`から共通の定数を再エクスポートします。

#### `diffUtils.ts`
テキストの差分を生成・管理するためのユーティリティ。2つのテキスト間の最長共通部分列（LCS）を計算し、追加、削除、共通の行を識別して`DiffLine`オブジェクトの配列として返します。`DiffManager`クラスは、差分ブロックの選択状態を管理し、選択された変更に基づいて新しいコンテンツを生成する機能を提供します。

#### `formatUtils.ts`
（空ファイル）


---

### バックエンド (Python/FastAPI)

- `server/src/main.py`: FastAPIアプリケーションのエントリーポイント。
- `server/src/routers/`: 認証、ヘルスチェック、LLM、ノート関連のAPIエンドポイント。
- `server/src/models/`: ユーザー、ノート、バージョンなどのデータモデル。
- `server/src/services/`: LLM、ノート、差分、バージョン管理などのビジネスロジック。
- `server/src/clients/`: LLMクライアント（OpenAI、ローカルLLM）。
- `server/src/core/`: 設定、データベース、例外処理、セキュリティ関連。
- `server/src/utils/`: ヘルパー関数。

---
