---
filename:  003_change_data_structure # "[id]_[issueのタイトル]"
id: 3 # issueのユニークID
status: new # new | in-progress | blocked | pending-review | done
priority: high # A:high | B:medium | C:low
attempt_count: 0 # このissueへの挑戦回数。失敗のたびにインクリメントする
tags: [architecture, data, refactoring] # 例: [UI, navigation, bug]
---

## 概要 (Overview)

> アプリケーションの基盤となるデータ構造を根本的に見直し、変更します。

## 背景 (Background)

> 現在のAsyncStorageをベースとしたフラットなデータ構造では、ファイルやフォルダの階層的な管理、特にゴミ箱機能のような複雑な操作において、設計上の限界と実装の複雑さが顕在化しました。今後の機能拡張やパフォーマンスを考慮すると、より堅牢で柔軟なデータ管理システムへの移行が不可欠です。

## 実装方針 (Implementation Strategy)

> 階層構造やリレーションシップを効率的に扱える、新しいデータベース方式の導入を検討します。具体的な技術選定はこれからですが、既存のAsyncStorageからのスムーズな移行パスも考慮に入れます。

## 受け入れ条件 (Acceptance Criteria)

> - [ ] 新しいデータ構造が導入され、アプリケーション全体で利用されていること。
> - [ ] 既存の主要機能（ファイルリスト表示、ファイル編集、フォルダ管理など）が新しいデータ構造上で問題なく動作すること。
> - [ ] パフォーマンスが既存と同等か、それ以上に改善されていること。

## 関連ファイル (Related Files)

> - `app/data/` ディレクトリ配下の全ファイル
> - データアクセス層に関わる全てのファイル

## 制約条件 (Constraints)

> - 既存のユーザーデータとの互換性を可能な限り維持すること。
> - アプリケーションの起動速度や操作感に悪影響を与えないこと。
> - モバイル環境での利用に適した技術を選定すること。

## 開発ログ (Development Log)

---
### 試行 #1

- **試みたこと:** （実行した計画の要約）
- **結果:** （成功、失敗、発生したエラーなど）
- **メモ:** （次のセッションへの申し送り事項、気づきなど）

---

## AIへの申し送り事項 (Handover to AI)

> - **現在の状況:** データ構造変更の大方針が決定し、issueが起票されました。
> - **次のアクション:** 新しいデータ構造の候補となる技術（例: SQLite, Realm DB, WatermelonDBなど）について調査し、それぞれの特徴、メリット・デメリット、導入の容易さ、既存システムとの親和性などを比較検討してください。
> - **考慮事項/ヒント:** 特に、React Native環境での利用実績、オフライン対応、データ移行の複雑さについて重点的に調査してください。
