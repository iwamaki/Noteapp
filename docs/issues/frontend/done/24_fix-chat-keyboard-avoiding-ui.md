---
title: "チャット入力欄のキーボード追従とUI一貫性の改善"
id: 24
status: done
priority: high
attempt_count: 0
tags: [UI, bug, chat, keyboard]
---

## 概要 (Overview)

> このIssueは、チャット機能におけるユーザーエクスペリエンスの向上を目的とします。具体的には、テキスト入力時にソフトウェアキーボード（IME）が表示された際、入力欄がキーボードに隠れてしまう問題を解決し、入力欄フォーカス前後でのUIの見た目の一貫性を確保します。

## 背景 (Background)

> 現在の実装では、`NoteListScreen` および `NoteEditScreen` のチャット入力欄（`ChatInputBar`）が、キーボード表示時に適切にリサイズまたは移動されず、結果として入力中のテキストがキーボードに隠れてしまいます。これにより、ユーザーは自身が何を入力しているか確認できず、UXが著しく低下しています。
> また、入力欄をタップする（フォーカスする）前後で、入力欄と隣のボタン（非入力時は「チャット」、入力時は「送信」）のスタイルやレイアウトが変動してしまい、視覚的な一貫性が損なわれています。これらの問題を解決し、スムーズなチャット操作を実現する必要があります。

## 受け入れ条件 (Acceptance Criteria)

> - [x] チャット入力欄にフォーカスし、キーボードが表示された際、入力欄がキーボードの直上に表示されること。
> - [x] 入力中のテキストが常に画面に表示され、キーボードに隠れないこと。
> - [x] チャット入力欄へのフォーカス前後で、入力欄と「チャット/送信」ボタンのレイアウトやスタイルが大きく変化しないこと。
> - [x] 上記の修正が `NoteListScreen` と `NoteEditScreen` の両方の画面で適用されていること。

## 制約事項 (Constraints)

チャット機能のUIは、**テキスト入力欄と送信ボタンのみで構成してください。** LINEのチャット入力欄のような、極めてシンプルなデザインを目指します。

*   **単一のUIパターンを維持**: 入力欄がフォーカスされているか否か、キーボード（IME）が表示されているか否かに関わらず、**常に単一のUIパターンを維持してください。** 異なる状態に応じてUIの見た目（レイアウト、サイズ、スタイル、要素の有無、内容）が変化するような実装は**絶対に避けてください。**
*   **IMEへの追従（画面上の位置調整のみ）**: キーボード（IME）が表示された際には、入力欄がキーボードの直上に表示されるように、**画面上での垂直方向の位置のみを動的に調整してください。** この位置調整の際も、UI要素のレイアウトやスタイルは変更しないでください。

## 理想的なUI (Ideal UI)

以下は、チャット入力UIの理想的な状態を示します。

### キーボード非表示時

> - `docs/issues/frontend/chat_input_closed.svg`

### キーボード表示時

> - `docs/issues/frontend/chat_input_open.svg`

## 関連ファイル (Related Files) 

> - `src/features/chat/ChatPanel.tsx`
> - `src/features/chat/components/ChatInputBar.tsx`
> - `src/features/note-list/NoteListScreen.tsx`
> - `src/features/note-edit/NoteEditScreen.tsx`
> - `src/utils/commonStyles.ts`
その他必要に応じて別のファイルも確認すること。


## 開発ログ (Development Log)

> このissueに関する作業の履歴を時系列で記録します。
> セッションをまたいで作業する際の引き継ぎ情報となります。

---
### 試行 #1


---
