---
title: "フロントエンド：LLMコマンドを解釈・実行する機構の実装"
id: 29
status: done
priority: high
attempt_count: 0
tags: [frontend, LLM, editor, command-handler, architecture]
---

## 概要 (Overview)

> バックエンドから送られてくるLLMコマンド（例: `edit_file`）をフロントエンド側で受信し、コマンドの種類に応じて適切なアクションを実行するための、柔軟で拡張性の高い機構を実装する。
> この機構は、将来的に様々な種類のコマンドやアクション（直接編集、差分表示、ユーザーへの通知など）に対応できるような設計を目指す。

## 背景 (Background)

> バックエンドがLLMの判断に基づき構造化されたコマンドを返せるようになった後、フロントエンドにはそのコマンドを解釈し、UIに反映させる責務が生まれる。
> 単純な実装は将来的な仕様変更（例:「差分確認なしで直接反映したい」）に対応しづらく、技術的負債になりやすい。そのため、初期実装の段階から保守性・拡張性を考慮したアーキテクチャを導入することが、プロジェクト全体の健全性のために重要となる。

## 受け入れ条件 (Acceptance Criteria)

> このissueが「完了」と見なされるための具体的な条件をチェックリスト形式で記述します。
>
> - [x] `NoteEditScreen`、またはそこから責務を委譲されたモジュール（フックなど）に、LLMコマンドを解釈するハンドラが実装されている。
> - [x] コマンドの種類 (`action`) に応じて、実行する処理を振り分ける仕組みが用意されている。
> - [x] アクションの具体的な実装（UIの更新、画面遷移など）は、ハンドラのコアロジックから分離されており、将来的な追加・変更が容易になっている。
> - [x] 初期実装として、`edit_file`コマンドを受け取った場合、既存の差分表示画面 (`DiffViewScreen`) に遷移し、LLMの提案内容との差分を表示するアクションが実装されている。
> - [x] 差分表示画面でユーザーが「適用」を選択した場合、LLMの提案内容が編集中のノートの状態に反映される。

## 関連ファイル (Related Files)

> このissueに関連すると思われるファイルやディレクトリのリストです。
> LLMがコード分析を始める際のヒントになります。
>
> - `src/features/note-edit/NoteEditScreen.tsx`
> - `src/features/diff-view/DiffViewScreen.tsx`
> - `src/navigation/RootNavigator.tsx`
> - `src/services/llmService.ts`
> - `src/hooks/`

## 開発ログ (Development Log)

> このissueに関する作業の履歴を時系列で記録します。
> セッションをまたいで作業する際の引き継ぎ情報となります。

---
### 試行 #1

- **試みたこと:** （実行した計画の要約）
- **結果:** （成功、失敗、発生したエラーなど）
- **メモ:** （次のセッションへの申し送り事項、気づきなど）

---
